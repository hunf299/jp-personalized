import { saveSession, listSessions } from '../../../lib/server/db'; export default async function handler(req,res){ try{ if(req.method==='GET'){ const { type }=req.query||{}; const rows=await listSessions(type||null); return res.json(rows);} if(req.method==='POST'){ const body=typeof req.body==='string'? JSON.parse(req.body):req.body; const { type, cards, summary }=body||{}; const id=await saveSession({ type, cards, summary }); return res.json({ id }); } return res.status(405).end(); }catch(e){ res.status(500).json({ error:String(e) }); }}